# PicoCTF Write-Up ( Web Exploitation )

<img align="right" width="250" src="https://i.pinimg.com/originals/94/ea/c8/94eac835763ea2c2b63c069cedbed22f.gif">

<!--
Available Write Up : ~

PicoCTF 2019
PicoCTF 2021
picoMini by redpwn
PicoCTF 2022
PicoCTF 2023
PicoCTF 2024
-->

[**PicoCTF 2019 :**](#PicoCTF-2019) 
- [**dont-use-client-side**](#dont-use-client-side)
- [**logon**](#logon)
- [**Insp3ct0r**](#insp3ct0r)
- [**where are the robots**](#where-are-the-robots)

[**PicoCTF 2021 :**](#picoctf-2021)
- [**cookies**](#cookies)
- [**Scavenger Hunt**](#scavenger-hunt)
- [**GET aHEAD**](#get-ahead)
- [**Who are you?**](#who-are-you?)
- [**More Cookies**](#more-cookies)
- [**It is my birthday**](#it-is-my-birthday)

[**picoMini by redpwn**](#picoMini-by-redpwn)
- [**caas**](#caas)
- [**login**](#login)

[**PicoCTF 2022**](#picoctf-2022)
- [**Local Authority**](#local-authority)
- [**Inspect HTML**](#inspect-html)
- [**Includes**](#includes)
- [**SQLiLite**](#sqlilite)
- [**SQL Direct**](#sql-direct)
- [**Secrets**](#secrets)
- [**Search Source**](#search-source)
- [**Roboto Sans**](#roboto-sans)
- [**Power Cookie**](#power-cookie)
- [**Forbidden Paths**](#forbidden-paths)

[**PicoCTF 2023**](#picoctf-2023)
- [**SOAP**](#soap)
- [**More SQLi**](#more-sqli)
- [**MatchTheRegex**](#match-the-regex)
- [**findme**](#findme)

[**PicoCTF 2024**](#picoctf-2024)
- [**WebDecode**](#webdecode)
- [**Unminify**](#unminify)
- [**IntroToBurp**](#intro-to-burp)
- [**Bookmarklet**](#bookmarklet)
- [**Trickster**](#trickster)

## PicoCTF 2019
- ### dont-use-client-side

This Task provide us with [url](https://jupiter.challenges.picoctf.org/problem/37821/) Shown a secure login portal

![ducs](img/ducs-1.PNG)

Try to bypass with ``admin' or '1'='1`` but it shows ``Incorrect password``

Found an interesting Code 

```
<script type="text/javascript">
  function verify() {
    checkpass = document.getElementById("pass").value;
    split = 4;
    if (checkpass.substring(0, split) == 'pico') {
      if (checkpass.substring(split*6, split*7) == 'a3c8') {
        if (checkpass.substring(split, split*2) == 'CTF{') {
         if (checkpass.substring(split*4, split*5) == 'ts_p') {
          if (checkpass.substring(split*3, split*4) == 'lien') {
            if (checkpass.substring(split*5, split*6) == 'lz_1') {
              if (checkpass.substring(split*2, split*3) == 'no_c') {
                if (checkpass.substring(split*7, split*8) == '9}') {
                  alert("Password Verified")
                  }
                }
              }
      
            }
          }
        }
      }
    }
    else {
      alert("Incorrect password");
    }
    
</script>
```
Seeing ``pico`` and ``CTF{`` assuming this is the flag now lets analyze the code.

we can see that the password is being checked in a series of conditions. The password input is broken into multiple parts using the ``substring()`` function, which extracts specific parts of the string, and then compares them to hardcoded values.

The value of ``split`` is set to ``4``, meaning the password is divided into chunks of 4 characters for validation.

the ``verify`` function check password in parts :

1. First 4 Characthers (index 0-4)
- The condition ``checkpass.substring(0, split) == 'pico'`` tells us that the first 4 characters of the password must be ``'pico'``

2. Characters at index 24-28 (6th chunk):

- The condition ``checkpass.substring(split*6, split*7) == 'a3c8'`` checks that the 6th chunk of the password (characters 24-28) must be ``'a3c8'``.

3. Characters at index 4-8 (2nd chunk):

- The condition ``checkpass.substring(split, split*2) == 'CTF{'`` checks that the 2nd chunk of the password (characters 4-8) must be ``'CTF{'``.

4. Characters at index 16-20 (5th chunk):

- The condition ``checkpass.substring(split*4, split*5) == 'ts_p'`` checks that the 5th chunk of the password (characters 16-20) must be ``'ts_p'``.

5. Characters at index 12-16 (4th chunk):

- The condition ``checkpass.substring(split*3, split*4) == 'lien'`` checks that the 4th chunk of the password (characters 12-16) must be ``'lien'``.

6. Characters at index 20-24 (6th chunk):

- The condition ``checkpass.substring(split*5, split*6) == 'lz_1``' checks that the 6th chunk of the password (characters 20-24) must be ``'lz_1'``.

7. Characters at index 8-12 (3rd chunk):

- The condition ``checkpass.substring(split*2, split*3) == 'no_c'`` checks that the 3rd chunk of the password (characters 8-12) must be ``'no_c'``.

8. Last 4 characters (index 28-32):

- The condition ``checkpass.substring(split*7, split*8) == '9}'`` checks that the last chunk of the password (characters 28-32) must be ``'9}'``.

From the conditions we can arrange the password in order from ``0-4`` to ``4-8`` and so on then we will get the flag goes like this 

```picoCTF{no_clients_plz_1a3c89}```

- ### logon

In this task we've been given a [url](https://jupiter.challenges.picoctf.org/problem/13594/) Shown a login page, 

![logon-1](img/logon-1.PNG)

Got access with this credentials ``admin' or '1'='1`` but it shows ``No flag for you``

![logon-2](img/logon-2.PNG)

Power up your Burpsuite turn on ``intercept`` and direct the our url to ``Repeater``. We got Interesting response here

![logon-3](img/logon-3.PNG)

The response show our username, password that we input earlier and also admin that set to ``False``

```password="admin' or '1'='1"; username="admin' or '1'='1"; admin=False;```

change the admin value to ``True`` then We'll get the Flag

![logon-4](img/logon-4.PNG)

``picoCTF{th3_c0nsp1r4cy_l1v3s_d1c24fef}``

- ### Insp3ct0r

On this simple task We've been given a [url](https://jupiter.challenges.picoctf.org/problem/41511/) and a hint that says ``How do you inspect web code on a browser?, There's 3 parts``

That means theres 3 part of Flag that need to assemble together, hmm, Interesting.

<img alt="Insp3ct0r" height="150px" src="img/inspector.PNG">

As the Header of the page says inspect the Web then we'll get our 1st Flag ``<!-- Html is neat. Anyways have 1/3 of the flag: picoCTF{tru3_d3 -->``

How about the 2nd and 3rd Flag ? Take note here, rather then just inspect to get flag and view code, we can view file like ``css & js``. Just like this Page they use ``css`` and ``js`` to link and include as external file in HTML Document

View ``mycss.css`` and ``myjs.js`` file then you'll get 2nd and 3rd part of the flag 

``You need CSS to make pretty pages. Here's part 2/3 of the flag: t3ct1ve_0r_ju5t``

``Javascript sure is neat. Anyways part 3/3 of the flag: _lucky?832b0699}``

Assemble all the Flag then you'll get the real Flag : 
`` picoCTF{tru3_d3t3ct1ve_0r_ju5t_lucky?832b0699}``

- ### where are the robots

Given a [url](https://jupiter.challenges.picoctf.org/problem/36474/) with a message ``Where are the robots?``. 

Im assuming ``robots`` that the page mention is ``robots.txt``

#### FYI : ``robots.txt`` is the filename used for implementing the ``Robots Exclusion Protocol``, a standard used by websites to indicate to visiting web crawlers and other web robots which portions of the website they are allowed to visit.

#### Simple Explain : ``robots.txt`` is a file on a website that tells search engines what they can and can't look at. It's like a "do not enter" sign for certain parts of the site. For example, you might block them from seeing private or unnecessary pages. 

The page mention ``Where are the robots?`` means we have to find they file, hmm, Interesting 

Lets use [Dirb](https://www.geeksforgeeks.org/introduction-to-dirb-kali-linux/) to search the robot file. Using this command

```dirb https://jupiter.challenges.picoctf.org/problem/36474/ /usr/share/wordlists/dirb/common.txt```

We'll get the result after several minutes.

<img alt="robots" height="250px" src="img/robots.PNG">

Open the url you'll see Disallow file named ``/477ce.html``. Open it then you'll see the Flag.

``picoCTF{ca1cu1at1ng_Mach1n3s_477ce}``

- ### Irish-Name-Repo 1
- ### Client-side-again
- ### picobrowser

## PicoCTF 2021
- ### Cookies

For this task we've been given a cookie search page

<img alt="cookies" height="350px" src="img/cookies.PNG">

put any cookies in the search bar eg : snickerdoodle, you'll get nothing and not a flag.

Well lets take a look at cookies on Developer Tools

<img alt="cookies" height="350px" src="img/cookies-1.PNG">

Edit the value from `0` to `1` you'll get another cookies, which means we On Something here

The Cookie Value that shows flag is around 10 - 20

<img alt="cookies" src="img/cookies-2.PNG">

`picoCTF{3v3ry1_l0v3s_c00k135_064663be}`

- ### Scavenger Hunt

For this chall its the same as [**Insp3ct0r**](#insp3ct0r) but with a little twist. There's 5 Part of the flag, 1st,2nd flag you'll get while view source. 

```
1: picoCTF{t > view-source
2: h4ts_4_l0 > mycss.css
```

The 4 and 5 are the twist. Theres clue shown own myjs.js file 

`/* How can I keep Google from indexing my website? */`

This one reminds me on robots.txt, take a look at robots.txt you'll get 3rd part of the flag

```
1: picoCTF{t > view-source
2: h4ts_4_l0 > mycss.css
3: t_0f_pl4c > robots.txt
```

Another clue occured `I think this is an apache server... can you Access the next flag?` [Apache Server](https://www.sumologic.com/blog/apache-web-server-introduction/#:~:text=Simply%20put%2C%20Apache%20HTTP%20server,using%20an%20Apache%20HTTP%20server.) that only has different configuration file which is `.htaccess`. Open it you'll get 4th flag

```
1: picoCTF{t > view-source
2: h4ts_4_l0 > mycss.css
3: t_0f_pl4c > robots.txt
4: 3s_2_lO0k > .htaccess
```

we got another clue for the last flag `I love making websites on my Mac, I can Store a lot of information there.`

You dont need Mac for this one, do some research abot [Mac Storage Management](https://iboysoft.com/howto/how-to-free-up-space-on-macintosh-hd.html). You'll notice a file named `.DS_Store`, open it then you'll get the last flag. Assemble it together will give a flag

```
1: picoCTF{t > view-source
2: h4ts_4_l0 > mycss.css
3: t_0f_pl4c > robots.txt
4: 3s_2_lO0k > .htaccess
5: _fa04427c} > .DS_Stire

picoCTF{th4ts_4_l0t_0f_pl4c3s_2_lO0k_fa04427c}
```

- ### GET aHEAD

For this chall given a website that shows red and blue, as usual view source the web, then you'll find some interesting code 

```
<div class="panel panel-primary" style="margin-top:50px">
						<div class="panel-heading">
							<h3 class="panel-title" style="color:red">Red</h3>
						</div>
						<div class="panel-body">
							<form action="index.php" method="GET">
								<input type="submit" value="Choose Red"/>
							</form>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="panel panel-primary" style="margin-top:50px">
						<div class="panel-heading">
							<h3 class="panel-title" style="color:blue">Blue</h3>
						</div>
						<div class="panel-body">
							<form action="index.php" method="POST">
								<input type="submit" value="Choose Blue"/>
							</form>
						</div>
					</div>
```
Notice there's 2 different Request Method `POST` & `GET`.  Probably referring to a third method and we can see `HEAD` popping out in the title. Let's try a `HEAD` request

change the Request Method from POST to HEAD, then you'll get the flag

<img src="img/get-ahead.PNG">

`picoCTF{r3j3ct_th3_du4l1ty_70bc61c4}`

- ### Who are you?

For this task, given a webpage that shows `Only people who use the official PicoBrowser are allowed on this site!`

<img src="img/who-are-you.PNG">

Intercept this website on BurpSuite, then change `User-Agent` to PicoBrowser.

<img src="img/who-are-you-1.PNG">

We onto something here. LoL

since it does'nt trust user visiting from another site add `Referer : mercury.picoctf.net:1270`, you'll get this output

`Sorry, this site only worked in 2018.`

so now we add a date header to assure the request is being made in 2018.

`Date: Wed, 21 Oct 2018 07:28:00 GMT`, then we'll get this output

`I don't trust users who can be tracked.`

so we use DNT Header (Do Not Track Header)
> The DNT (Do Not Track) request header **indicates the user’s tracking preference**. It lets users indicate whether they would prefer privacy rather than personalized content.

`DNT: 1`, You'll get this output

`This website is only for people from Sweden.`

now twe put `X-Forwarded-For: 102.177.146.0`, you'll get this output
> the ip is from googling Sweden IP Address

`You&#39;re in Sweden but you don&#39;t speak Swedish?`

Damn what this web want tho, why so demand 

now edit the `Accept-Language` to `sv-sv,sv;q=0.5`
> Accept-Language: sv-sv,sv;q=0.5

then you'll get the flag ( Finally )

`picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_f56f58a5}`

- ### More Cookies
- ### It Is my Birthday

## picoMini by redpwn
- ### cass

On this simple task, we've been provide with a website that shown [cowsay](https://ioflood.com/blog/install-cowsay-command-linux/#:~:text=In%20most%20Linux%20distributions%2C%20you,the%20tool%20was%20added%20successfully.)

We can make use of a Bash feature called [command substitution](https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_03). Simply put any code between backticks (`) or within $(), and the code will be evaluated before the main program.

Let’s try it by attempting to list the files in the current directory

<img src="img/caas.PNG">

We onto something here. to view the `falg.txt` use the cat command

`cat falg.txt`

`picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o}`

- ### login

On this real simple task, we've been given a login page, try to bypass but none is working, until i view source, and check `index.js`. Looks like base64

`cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ`

Once you decode it, you'll get the flag

## picoCTF 2022
- ### Local Authority
- ### Inspect HTML
- ### Includes
- ### SQLiLite
- ### SQL Direct
- ### Secrets
- ### Search Source
- ### Roboto Sans
- ### Power Cookie
- ### Forbidden Paths

## picoCTF 2023
- ### SOAP
- ### More SQLi
- ### MatchTheRegex
- ### findme

## picoCTF 2024
- ### WebDecode
- ### Unminify
- ### IntroToBurp
- ### Bookmarklet
- ### Trickster